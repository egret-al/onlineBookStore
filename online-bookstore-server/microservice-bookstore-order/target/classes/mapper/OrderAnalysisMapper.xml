<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.onlinebookstore.mapper.OrderAnalysisMapper">
    <resultMap id="orderCoordinateAxisItem" type="com.onlinebookstore.entity.orderserver.OrderCoordinateAxisItem">
        <result property="xAxisData" column="x"/>
        <result property="yAxisData" column="y"/>
    </resultMap>

    <select id="getBookNameAndCountWithDealtOrder" resultMap="orderCoordinateAxisItem">
        select book_name x, sum(product_count) y
        from sys_order
        where order_payment_status = 1
        <if test="day != -1">
            and order_payment_status = 1 and date_sub(curdate(), interval #{day} day ) &lt; date(create_time)
        </if>
        group by book_id
        order by sum(product_count) desc
        <if test="count != -1">
            limit #{count};
        </if>
    </select>

    <select id="getBookNameAndWholePriceWithDealtOrder" resultMap="orderCoordinateAxisItem">
        select book_name x, sum(whole_price) y
        from sys_order
        where order_payment_status = 1
        <if test="day != -1">
            and order_payment_status = 1 and date_sub(curdate(), interval #{day} day ) &lt; date(create_time)
        </if>
        group by book_id
        order by sum(whole_price) desc
        <if test="count != -1">
            limit #{count};
        </if>
    </select>
</mapper>